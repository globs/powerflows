{% extends 'base.html' %}

{% block content %}
    <h1>{% block title %} Powerflows admin console {% endblock %}</h1>
    Download file <a href="http://hulk1.vps.webdock.cloud:3333/api/v1/download/script.js"> Here</a>
    <h2>Latest Job runs history</h2>
    {% for trace in traces %}
        <span class="badge badge-primary">{{ trace[0] }} - {{ trace[1] }} - {{ trace[2] }}</span>
        <br>
        <p>
            <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseExample{{ trace[0] }}" aria-expanded="false" aria-controls="collapseExample{{ trace[0] }}">
            Trace Details
            </button>
          </p>
          <div class="collapse" id="collapseExample{{ trace[0] }}">
            <div class="card card-body">
                <p> {{ trace[3] }} ({{ trace[3]|length }}</p>
            </div>
          </div>

    {% endfor %}    
    <hr>
    <h2>Secrets</h2>
    {% for secret in secrets %}
    <a href="{{ url_for('display_secret', secret_name=secret['name']) }}">
        <h3>{{ secret['name'] }}</h3>
        <span class="badge badge-primary">{{ secret['create_date'] }}</span>
    </a><br>
    <a class="btn btn-primary" href="{{ url_for('edit_secret', secret_name=secret['name']) }}">
        Edit
    </a>
    <form action="{{ url_for('delete_secret', secret_name=secret['name']) }}" method="POST">
        <input type="submit" value="Delete Post"
                class="btn btn-danger btn-sm"
                onclick="return confirm('Are you sure you want to delete this post?')">
    </form>
    <hr>
    {% endfor %}
{% endblock %}